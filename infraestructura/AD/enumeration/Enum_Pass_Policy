Podemos tener un aproximado utilizando crackmapexec:
crackmapexec smb 172.16.5.5 -u avazquez -p Password123 --pass-pol

######### SMB NULL sessions LINUX:
SMB NULL sessions permite a un usuario no autenticado traer información del dominio, listas completas de usuarios, grupos, computadoras, atributos de las cuentas de usuario y las politicas de contraseñas.
Para esto podemos utilizar herramientas como enum4linux, crackmapexec, rpcclient

RPCClient:
rpcclient -U "" -N 172.16.5.5
obtener info del dominio
--querydominfo
obtener info de las politicas de pass
--getdompwinfo

Enum4linux:
enum4linux -P 172.16.5.5


enum4linux-ng
Esta herramienta es una extensión de la anterior y nos permite exportar los resultados en YAML o JSON.
enum4linux-ng -P 172.16.5.5 -oA ilfreight


####### SMB NULL sessions WINDOWS:
 net use \\DC01\ipc$ "" /u:""


############LDAP Anonymous BIND LINUX
permite a un usuario no autenticado traer información del dominio, listas completas de usuarios, grupos, computadoras, atributos de las cuentas de usuario y las politicas de contraseñas.
No se encuentra por defecto desde windows server 2003, sin embargo algunos admins la utilizan, por lo que no está de más verlo
podemos hacerlo con ldapsearch
ldapsearch -h 172.16.5.5 -x -b "DC=INLANEFREIGHT,DC=LOCAL" -s sub "*" | grep -m 1 -B 10 pwdHistoryLength

########### Enumeración de password policy desde windows:
desde cmd:
net accounts

tambien podemos hacerlo desde powershell con powerview:
import-module .\PowerView.ps1
Get-DomainPolicy
